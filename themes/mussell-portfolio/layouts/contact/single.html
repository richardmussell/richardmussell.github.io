{{ define "main" }}
<div class="container" style="padding-top: 2rem; padding-bottom: 3rem;">
  <div class="contact-hero">
    <h1>Let's Connect</h1>
    <p>Have a question, want to collaborate, or discuss the latest in cloud engineering and DevOps? I'd love to hear from you! Whether you're looking to collaborate on a project, learn together, or explore new opportunities, feel free to reach out.</p>
  </div>
  
  <div class="contact-form">
    <h2 class="form-title">Send a Message</h2>
    <p class="form-disclaimer">By submitting this form, you agree to our <a href="#">Privacy Policy</a>.</p>
    
    <div id="form-message" class="form-message" style="display: none;"></div>
    
    <form id="contact-form" action="https://formspree.io/f/mjknrrzo" method="POST">
      <div class="form-group">
        <label for="name">NAME *</label>
        <input type="text" id="name" name="name" placeholder="Your full name" required aria-required="true">
        <span class="error-message" id="name-error"></span>
      </div>
      
      <div class="form-group">
        <label for="email">EMAIL *</label>
        <input type="email" id="email" name="email" placeholder="your.email@example.com" required aria-required="true">
        <span class="error-message" id="email-error"></span>
      </div>
      
      <div class="form-group">
        <label for="subject">SUBJECT</label>
        <input type="text" id="subject" name="subject" placeholder="What's this about? (optional)">
        <p class="form-hint">Optional - helps me understand the context of your message</p>
      </div>
      
      <div class="form-group">
        <label for="message">MESSAGE *</label>
        <textarea id="message" name="message" placeholder="Tell me about your project, question, or how we can collaborate..." maxlength="2000" required aria-required="true"></textarea>
        <div class="char-count">
          <span id="char-count">0</span> / 2000 characters
        </div>
        <span class="error-message" id="message-error"></span>
      </div>
      
      <!-- Honeypot field for spam protection -->
      <input type="text" name="_gotcha" style="display: none;" tabindex="-1" autocomplete="off">
      
      <div class="form-actions">
        <button type="reset" class="btn btn-secondary" id="reset-btn">Clear</button>
        <button type="submit" class="btn btn-primary" id="submit-btn">
          <span class="btn-text">Send Message</span>
          <span class="btn-loader" style="display: none;">Sending...</span>
        </button>
      </div>
    </form>
  </div>
</div>

<script>
  (function() {
    'use strict';
    
    const form = document.getElementById('contact-form');
    const messageTextarea = document.getElementById('message');
    const charCount = document.getElementById('char-count');
    const formMessage = document.getElementById('form-message');
    const submitBtn = document.getElementById('submit-btn');
    const resetBtn = document.getElementById('reset-btn');
    const btnText = submitBtn.querySelector('.btn-text');
    const btnLoader = submitBtn.querySelector('.btn-loader');
    
    // Character counter
    messageTextarea.addEventListener('input', function() {
      charCount.textContent = this.value.length;
    });
    
    // Clear error messages
    function clearErrors() {
      document.querySelectorAll('.error-message').forEach(el => {
        el.textContent = '';
        el.style.display = 'none';
      });
      document.querySelectorAll('.form-group input, .form-group textarea').forEach(el => {
        el.classList.remove('error');
      });
    }
    
    // Show error message
    function showError(fieldId, message) {
      const errorEl = document.getElementById(fieldId + '-error');
      const fieldEl = document.getElementById(fieldId);
      if (errorEl) {
        errorEl.textContent = message;
        errorEl.style.display = 'block';
      }
      if (fieldEl) {
        fieldEl.classList.add('error');
      }
    }
    
    // Show form message
    function showMessage(message, type) {
      formMessage.textContent = message;
      formMessage.className = 'form-message ' + type;
      formMessage.style.display = 'block';
      
      // Scroll to message
      formMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      
      // Auto-hide after 5 seconds for success
      if (type === 'success') {
        setTimeout(() => {
          formMessage.style.display = 'none';
        }, 5000);
      }
    }
    
    // Set loading state
    function setLoading(loading) {
      if (loading) {
        submitBtn.disabled = true;
        btnText.style.display = 'none';
        btnLoader.style.display = 'inline';
        resetBtn.disabled = true;
      } else {
        submitBtn.disabled = false;
        btnText.style.display = 'inline';
        btnLoader.style.display = 'none';
        resetBtn.disabled = false;
      }
    }
    
    // Form validation
    function validateForm() {
      clearErrors();
      let isValid = true;
      
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const message = document.getElementById('message').value.trim();
      
      if (!name) {
        showError('name', 'Name is required');
        isValid = false;
      }
      
      if (!email) {
        showError('email', 'Email is required');
        isValid = false;
      } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        showError('email', 'Please enter a valid email address');
        isValid = false;
      }
      
      if (!message) {
        showError('message', 'Message is required');
        isValid = false;
      } else if (message.length < 10) {
        showError('message', 'Message must be at least 10 characters');
        isValid = false;
      }
      
      return isValid;
    }
    
    // Form submission
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      if (!validateForm()) {
        showMessage('Please correct the errors above', 'error');
        return;
      }
      
      clearErrors();
      setLoading(true);
      formMessage.style.display = 'none';
      
      try {
        const formData = new FormData(form);
        const response = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });
        
        if (response.ok) {
          showMessage('Thank you! Your message has been sent successfully. I will get back to you soon.', 'success');
          form.reset();
          charCount.textContent = '0';
        } else {
          const data = await response.json();
          if (data.errors) {
            showMessage('There was an error submitting the form. Please try again.', 'error');
          } else {
            showMessage('There was an error submitting the form. Please try again.', 'error');
          }
        }
      } catch (error) {
        showMessage('Network error. Please check your connection and try again.', 'error');
      } finally {
        setLoading(false);
      }
    });
    
    // Reset form
    resetBtn.addEventListener('click', function() {
      clearErrors();
      formMessage.style.display = 'none';
      charCount.textContent = '0';
    });
    
    // Real-time validation
    ['name', 'email', 'message'].forEach(fieldId => {
      const field = document.getElementById(fieldId);
      field.addEventListener('blur', function() {
        if (this.value.trim()) {
          validateForm();
        }
      });
    });
  })();
</script>
{{ end }}



