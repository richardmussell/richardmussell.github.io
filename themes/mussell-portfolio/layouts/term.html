{{ define "main" }}
{{ $categoryLower := lower .Title }}
<div class="container">
  <!-- Technical Capability Header -->
  <div class="north-star-section">
    <h1 class="category-title">{{ .Title }}</h1>
    <p class="engineering-philosophy">Focusing on Immutable Infrastructure, GitOps state reconciliation, and Shift-Left security to drive engineering velocity.</p>
    <div class="north-star-metrics">
      {{ if or (eq $categoryLower "release engineering & ci/cd") (eq $categoryLower "release-engineering--ci-cd") }}
      <!-- DORA Metrics for Release Engineering -->
      <div class="metric-box">
        <div class="metric-label">Lead Time for Changes</div>
        <div class="metric-value"> &lt; 1 Hour</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Deployment Frequency</div>
        <div class="metric-value">On-Demand</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Change Failure Rate</div>
        <div class="metric-value"> &lt; 5%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">MTTR</div>
        <div class="metric-value"> &lt; 30 Minutes</div>
      </div>
      {{ else if or (eq $categoryLower "distributed systems & scale") (eq $categoryLower "distributed-systems--scale") }}
      <!-- Distributed Systems Metrics -->
      <div class="metric-box">
        <div class="metric-label">P99 Latency</div>
        <div class="metric-value"> &lt; 50ms</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Cluster Uptime</div>
        <div class="metric-value">99.95%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Auto-scaling Response</div>
        <div class="metric-value"> &lt; 5 Minutes</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Multi-Cluster Sync</div>
        <div class="metric-value"> &lt; 30s</div>
      </div>
      {{ else if or (eq $categoryLower "sre & security engineering") (eq $categoryLower "sre--security-engineering") }}
      <!-- Reliability & Security Metrics -->
      <div class="metric-box">
        <div class="metric-label">SLA/SLO Compliance</div>
        <div class="metric-value">99.9%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">MTTD</div>
        <div class="metric-value"> &lt; 5 Minutes</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Audit Pass Rate</div>
        <div class="metric-value">100%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Zero Trust Coverage</div>
        <div class="metric-value">100%</div>
      </div>
      {{ else if or (eq $categoryLower "platform engineering & governance") (eq $categoryLower "platform-engineering--governance") }}
      <!-- Platform Engineering Metrics -->
      <div class="metric-box">
        <div class="metric-label">Self-Service Time</div>
        <div class="metric-value"> &lt; 5 Minutes</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">FinOps Savings</div>
        <div class="metric-value">35%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Policy Compliance</div>
        <div class="metric-value">100%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Developer Velocity</div>
        <div class="metric-value">+70%</div>
      </div>
      {{ else }}
      <!-- Default Metrics -->
      <div class="metric-box">
        <div class="metric-label">System Availability</div>
        <div class="metric-value">99.9%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Automation Coverage</div>
        <div class="metric-value">95%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">IaC Coverage</div>
        <div class="metric-value">100%</div>
      </div>
      <div class="metric-box">
        <div class="metric-label">Documentation</div>
        <div class="metric-value">Complete</div>
      </div>
      {{ end }}
    </div>
  </div>

  <!-- Capability Stack -->
  <div class="capability-stack-section">
    <h2 class="section-heading">
      <span class="status-indicator"></span>
      <span class="heading-label">CAPABILITY_STACK</span>
    </h2>
    <div class="capability-grid">
      {{ if or (eq $categoryLower "release engineering & ci/cd") (eq $categoryLower "release-engineering--ci-cd") }}
      <div class="capability-group">
        <div class="capability-label">Orchestration:</div>
        <div class="capability-tools">ArgoCD, Helm, Kustomize</div>
      </div>
      <div class="capability-group">
        <div class="capability-label">CI/CD & Automation:</div>
        <div class="capability-tools">GitHub Actions, GitLab CI</div>
      </div>
      <div class="capability-group">
        <div class="capability-label">Security & Quality:</div>
        <div class="capability-tools">Snyk, SonarQube, Checkov (Shift-Left)</div>
      </div>
      {{ else if or (eq $categoryLower "distributed systems & scale") (eq $categoryLower "distributed-systems--scale") }}
      <div class="capability-group">
        <div class="capability-label">Orchestration:</div>
        <div class="capability-tools">Kubernetes, kubeadm, ArgoCD</div>
      </div>
      <div class="capability-group">
        <div class="capability-label">Networking:</div>
        <div class="capability-tools">Calico, Cilium, CNI</div>
      </div>
      <div class="capability-group">
        <div class="capability-label">Observability:</div>
        <div class="capability-tools">Prometheus, Grafana, CloudWatch</div>
      </div>
      {{ else if or (eq $categoryLower "sre & security engineering") (eq $categoryLower "sre--security-engineering") }}
      <div class="capability-group">
        <div class="capability-label">Monitoring:</div>
        <div class="capability-tools">Prometheus, Grafana, ELK</div>
      </div>
      <div class="capability-group">
        <div class="capability-label">Security:</div>
        <div class="capability-tools">Falco, Trivy, CIS Benchmarks</div>
      </div>
      <div class="capability-group">
        <div class="capability-label">Compliance:</div>
        <div class="capability-tools">NIST, SOC 2, Zero Trust</div>
      </div>
      {{ else }}
      <div class="capability-group">
        <div class="capability-label">Infrastructure:</div>
        <div class="capability-tools">Terraform, Ansible, CloudFormation</div>
      </div>
      <div class="capability-group">
        <div class="capability-label">Automation:</div>
        <div class="capability-tools">GitHub Actions, GitLab CI, Jenkins</div>
      </div>
      <div class="capability-group">
        <div class="capability-label">Observability:</div>
        <div class="capability-tools">Prometheus, Grafana, CloudWatch</div>
      </div>
      {{ end }}
    </div>
  </div>

  <!-- System Records (Horizontal Layout) -->
  <div class="system-records-section">
    <div class="system-records-list">
      {{ range .Pages }}
      <article class="system-record">
        <div class="record-status-badge">
          {{ if .Params.productionReady }}
          <span class="status-badge status-stable">[STABLE]</span>
          {{ else }}
          <span class="status-badge status-active">[ACTIVE]</span>
          {{ end }}
        </div>
        
        <div class="record-identity">
          <h3 class="record-title">
            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
          </h3>
          <p class="record-objective">{{ .Description }}</p>
        </div>
        
        <div class="record-impact">
          {{ if .Params.impactMetrics }}
            {{ range first 3 .Params.impactMetrics }}
            {{ $metricLower := lower . }}
            <div class="record-impact-chip">
              {{ if findRE "cost|reduction|save" $metricLower }}
                <span class="impact-icon">‚ö°</span>
              {{ else if findRE "security|trust|zero" $metricLower }}
                <span class="impact-icon">üõ°Ô∏è</span>
              {{ else if findRE "rto|latency|time|minute|min" $metricLower }}
                <span class="impact-icon">‚åõ</span>
              {{ else if findRE "uptime|sla|availability" $metricLower }}
                <span class="impact-icon">‚úì</span>
              {{ else }}
                <span class="impact-icon">‚Ä¢</span>
              {{ end }}
              <span class="impact-text">{{ . }}</span>
            </div>
            {{ end }}
          {{ end }}
        </div>
        
        <div class="record-stack-action">
          <div class="record-stack-icons">
            {{ if .Params.iac }}
            <span class="stack-icon-mini" title="{{ .Params.iac }}">üìã</span>
            {{ end }}
            {{ if .Params.provider }}
            <span class="stack-icon-mini" title="{{ .Params.provider }}">‚òÅÔ∏è</span>
            {{ end }}
            {{ $tagsLower := lower (delimit .Params.tags " ") }}
            {{ if findRE "kubernetes|k8s" $tagsLower }}
            <span class="stack-icon-mini" title="Kubernetes">‚öì</span>
            {{ end }}
          </div>
          <a href="{{ .RelPermalink }}" class="record-link">View Specs ‚Üí</a>
        </div>
      </article>
      {{ end }}
    </div>
  </div>

  <!-- Elite Footer -->
  <div class="elite-footer">
    <p class="footer-text">Interested in discussing deployment patterns, scaling bottlenecks, or infrastructure-as-code strategy? Let's connect.</p>
    <a href="{{ "/contact/" | relURL }}" class="terminal-link">$ contact</a>
  </div>
</div>
{{ end }}
